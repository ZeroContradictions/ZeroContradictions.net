/* Zero Contradictions Org-Mode Essays Javascript (https://zerocontradictions.net/programming/script.js) © 2025 by Zero Contradictions is licensed under CC BY 4.0 (https://creativecommons.org/licenses/by/4.0/) */
document.addEventListener("DOMContentLoaded",(function(){let t=document.getElementById("org-div-home-and-up");const e=document.getElementById("table-of-contents"),n=document.getElementById("TOC-link");let o=window.scrollY;if(e){var i=e.cloneNode(!0);i.id="floating-toc",i.style.display="none",document.body.appendChild(i)}n.addEventListener("click",(function(t){t.preventDefault(),i.style.display="none"===i.style.display?"block":"none"})),i.addEventListener("click",(function(t){"A"===t.target.tagName&&(i.style.display="none")})),document.addEventListener("click",(function(t){"block"!==i.style.display||i.contains(t.target)||t.target===n||(i.style.display="none")})),window.addEventListener("scroll",(function(){const e=window.scrollY;t.style.top=e>o?"-10rem":"0",o=e}));const s=document.getElementById("theme-link"),a=document.documentElement;let l=localStorage.getItem("theme")||"auto";function r(t){a.classList.remove("light-mode","dark-mode"),"dark"===t?(a.classList.add("dark-mode"),s.textContent="LIGHT",localStorage.setItem("theme","dark")):"light"===t?(a.classList.add("light-mode"),s.textContent="DARK",localStorage.setItem("theme","light")):(s.textContent="DARK",localStorage.removeItem("theme"))}s.addEventListener("click",(t=>{t.preventDefault(),l="dark"===l?"light":"dark",r(l)})),r(l),document.addEventListener("keydown",(function(t){"c"===t.key.toLowerCase()?i&&(i.style.display="none"===i.style.display?"block":"none"):"d"===t.key.toLowerCase()&&(l="dark"===l?"light":"dark",r(l))}));const c=document.createElement("div");c.className="image-overlay",c.style.cssText="\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.6); /* Less dark background */\n\tdisplay: none;\n\tjustify-content: center;\n\talign-items: center;\n\tz-index: 1000;\n\toverflow: hidden;\n  ";const d=document.createElement("div");d.className="overlay-img-container",d.style.cssText="\n\tposition: relative;\n\tmax-width: 90%;\n\tmax-height: 90%;\n\toverflow: visible;\n  ";const p=document.createElement("img");p.className="overlay-img",p.style.cssText="\n\tmax-width: 100%;\n\tmax-height: 80vh; /* Reduced to leave room for caption */\n\tcursor: grab;\n\ttransition: transform 0.2s ease;\n  ";const u=document.createElement("div");u.className="caption-container",u.style.cssText="\n\tposition: absolute;\n\ttop: 100%; // Display captions directly below images\n\tleft: 0;\n\tright: 0;\n\tbackground-color: rgba(0, 0, 0, 0.6);\n\tcolor: white;\n\tpadding: 10px;\n\ttext-align: center;\n\tfont-size: 36px;\n  ";const m=document.createElement("div");m.className="image-counter",m.style.cssText="\n\tposition: fixed;\n\ttop: 20px;\n\tleft: 20px;\n\tbackground-color: rgba(0, 0, 0, 0.6);\n\tcolor: white;\n\tpadding: 5px 10px;\n\tborder-radius: 3px;\n\tfont-size: 36px;\n\tz-index: 1010;\n  ";const y=document.createElement("div");y.className="close-button",y.innerHTML="&#10005;",y.style.cssText="\n\tposition: fixed;\n\ttop: 20px;\n\tright: 20px;\n\tbackground-color: rgba(0, 0, 0, 0.6);\n\tcolor: white;\n\twidth: 50px;\n\theight: 50px;\n\tborder-radius: 50%;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tcursor: pointer;\n\tfont-size: 36px;\n\tz-index: 1010;\n\ttransition: background-color 0.3s;\n  ",y.onmouseover=()=>y.style.backgroundColor="rgba(0, 0, 0, 0.8)",y.onmouseout=()=>y.style.backgroundColor="rgba(0, 0, 0, 0.6)";const g=document.createElement("div");g.className="help-button",g.innerHTML="?",g.style.cssText="\n\tposition: fixed;\n\tbottom: 20px;\n\tright: 20px;\n\tbackground-color: rgba(0, 0, 0, 0.6);\n\tcolor: white;\n\twidth: 50px;\n\theight: 50px;\n\tborder-radius: 50%;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tcursor: pointer;\n\tfont-size: 36px;\n\tz-index: 1010;\n\ttransition: background-color 0.3s;\n  ";const h=document.createElement("div");h.className="help-tooltip",h.style.cssText="\n\tposition: absolute;\n\tbottom: 40px;\n\tright: 0;\n\tbackground-color: rgba(0, 0, 0, 0.8);\n\tcolor: white;\n\tpadding: 10px;\n\tborder-radius: 5px;\n\twidth: 500px;\n\tfont-size: 30px;\n\tline-height: 1.5;\n\topacity: 0;\n\tvisibility: hidden;\n\ttransition: opacity 0.3s, visibility 0.3s;\n\ttext-align: left;\n  ",h.innerHTML="\n\t<strong>Keyboard Shortcuts:</strong><br>\n\t← / → : Previous/Next image<br>\n\tSpace : Reset image size/position<br>\n\tESC : Close viewer<br>\n\tc : Show Table of Contents<br>\n\td : Dark/Light Mode\n  ";const f=document.createElement("div");f.className="nav-arrow prev",f.innerHTML="&#10094;",f.style.cssText="\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 20px;\n\tfont-size: 40px;\n\tcolor: white;\n\tcursor: pointer;\n\tuser-select: none;\n\topacity: 0.7;\n\ttransition: opacity 0.2s;\n\tz-index: 1010;\n  ",f.onmouseover=()=>f.style.opacity="1",f.onmouseout=()=>f.style.opacity="0.7";const b=document.createElement("div");b.className="nav-arrow next",b.innerHTML="&#10095;",b.style.cssText="\n\tposition: absolute;\n\ttop: 50%;\n\tright: 20px;\n\tfont-size: 40px;\n\tcolor: white;\n\tcursor: pointer;\n\tuser-select: none;\n\topacity: 0.7;\n\ttransition: opacity 0.2s;\n\tz-index: 1010;\n  ",b.onmouseover=()=>b.style.opacity="1",b.onmouseout=()=>b.style.opacity="0.7",g.addEventListener("mouseenter",(function(){h.style.opacity="1",h.style.visibility="visible",g.style.backgroundColor="rgba(0, 0, 0, 0.8)"})),g.addEventListener("mouseleave",(function(){h.style.opacity="0",h.style.visibility="hidden",g.style.backgroundColor="rgba(0, 0, 0, 0.6)"})),g.appendChild(h),d.appendChild(p),d.appendChild(u),c.appendChild(d),c.appendChild(f),c.appendChild(b),c.appendChild(m),c.appendChild(y),c.appendChild(g),document.body.appendChild(c);const x=document.createElement("style");x.innerHTML="\n\t.zoom-cursor {\n\t  cursor: zoom-in;\n\t}\n  ",document.head.appendChild(x);let v=[],k=0,w=1,L=0,E=0;function C(t){return!(!t.src||!t.src.toLowerCase().endsWith(".svg"))||"image/svg+xml"===t.getAttribute("type")}function z(){v=Array.from(document.querySelectorAll("img:not(.overlay-img)")),v.forEach(((t,e)=>{if(!t.dataset.galleryInitialized){const n=window.getComputedStyle(t),o=n.display,i=n.marginLeft,s=n.marginRight,a=n.float,l=window.getComputedStyle(t.parentNode).textAlign;if(C(t))return t.addEventListener("click",(function(){T(e)})),void(t.dataset.galleryInitialized="true");const r=document.createElement("div");r.className="gallery-img-wrapper";const c=["position: relative","overflow: visible","vertical-align: middle"];c.push(`display: ${"inline"===o?"inline-block":o}`),c.push(`margin-left: ${i}; margin-right: ${s};`),"auto"===i&&"auto"===s&&c.push("margin-left: auto; margin-right: auto; display: block;"),a&&"none"!==a&&c.push(`float: ${a};`),"center"===l&&c.push("text-align: center;"),t.style.width&&c.push(`width: ${t.style.width};`),r.style.cssText=c.join(";");const d=document.createElement("div");d.className="gallery-tooltip",d.textContent="Click to enlarge",d.style.cssText="\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tbottom: 10px;\n\t\t\t\t\tleft: 50%;\n\t\t\t\t\ttransform: translateX(-50%);\n\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.7);\n\t\t\t\t\tcolor: white;\n\t\t\t\t\tpadding: 5px 10px;\n\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\topacity: 0;\n\t\t\t\t\ttransition: opacity 0.3s ease;\n\t\t\t\t\tpointer-events: none;\n\t\t\t\t\tz-index: 10;\n\t\t\t\t";const p=t.cloneNode(!0);if(t.getAttribute("style")){const e=t.getAttribute("style").split(";").filter((t=>!t.trim().startsWith("position:"))).join(";");p.setAttribute("style",e)}p.className=t.className;t.parentNode.replaceChild(r,t),r.appendChild(p),r.appendChild(d),v[e]=p,r.addEventListener("mouseenter",(function(){d.style.opacity="1",p.classList.add("zoom-cursor")})),r.addEventListener("mouseleave",(function(){d.style.opacity="0",p.classList.remove("zoom-cursor")})),r.addEventListener("click",(function(){T(e)})),p.dataset.galleryInitialized="true"}}))}function T(t){k=t,N(k),c.style.display="flex",A()}function N(t){if(0===v.length)return;k=(t+v.length)%v.length;const e=v[k];p.src=e.src,p.alt=e.alt;C(e)?function(t){!t.src||!t.src.toLowerCase().endsWith(".svg")||(p.style.objectFit="contain")}(e):p.style.objectFit="";const n=function(t){const e=function(t,e){for(;t&&t.tagName!==e.toUpperCase();)t=t.parentElement;return t}(t,"figure");if(e){const t=e.querySelector("figcaption");if(t)return t.innerHTML}return t.alt||""}(e);u.innerHTML=n,u.style.display=n?"block":"none",m.textContent=`${k+1} of ${v.length}`,v.length<=1?(f.style.display="none",b.style.display="none"):(f.style.display="block",b.style.display="block")}function A(){w=1,L=0,E=0,p.style.transform=`translate(${L}px, ${E}px) scale(${w})`}function I(){N(k-1),A()}function S(){N(k+1),A()}function M(){c.style.display="none"}f.addEventListener("click",I),b.addEventListener("click",S),y.addEventListener("click",M),c.addEventListener("click",(function(t){t.target===c&&M()})),document.addEventListener("keydown",(function(t){if("none"!==c.style.display)switch(t.key){case"ArrowLeft":I();break;case"ArrowRight":S();break;case"Escape":M();break;case" ":t.preventDefault(),A()}})),z();new MutationObserver((function(t){t.forEach((function(t){"childList"===t.type&&z()}))})).observe(document.body,{childList:!0,subtree:!0})}));
